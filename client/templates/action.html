{% extends 'base.html' %}
{% load bootstrap5 %}
{% load static %}

{% block title %}
    Create Action for {{client}} BY {{current_user}}
{% endblock %}

{% block content %}
{% if form.non_field_errors %}

<div class="alert alert-danger" role="alert">
    {% for error in form.non_field_errors %}
        {{ error }}
    {% endfor %}
</div>
{% endif %}
<form method="post">
    {% csrf_token %}
 
    {{form.client}}
    {% bootstrap_form form layout=inline %}

  
    <button type="submit" class="btn btn-primary">Save Goal</button>
</form>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Get references to the elements
    const followUpPeriodSelect = document.getElementById('id_action_follow_up_period');
    const actionOutcomeRadios = document.querySelectorAll('input[name="action_outcome"]');
    const followUpPeriodLabel = document.querySelector('label[for="id_action_follow_up_period"]');

    // Function to toggle the visibility of the follow-up period
    function toggleFollowUpPeriodVisibility() {
        let requiresFollowUpSelected = false;
        // Check if any of the 'action_outcome' radio buttons are checked
        actionOutcomeRadios.forEach(radio => {
            if (radio.checked && radio.value === "Requires Follow-Up") {
                requiresFollowUpSelected = true;
            }
        });

        // Show or hide the follow-up period select element
        if (requiresFollowUpSelected) {
            followUpPeriodSelect.style.display = 'block'; // Or 'flex', 'inline-block' as appropriate for your CSS
            followUpPeriodLabel.style.display = 'block';
        } else {
            followUpPeriodSelect.style.display = 'none';
            followUpPeriodLabel.style.display = 'none';
        }
    }

    // Add event listeners to all radio buttons with the name 'action_outcome'
    actionOutcomeRadios.forEach(radio => {
        radio.addEventListener('change', toggleFollowUpPeriodVisibility);
    });

    // Initial check on page load
    toggleFollowUpPeriodVisibility();
});
</script>

<!--
 <script>
function updateFollowUpDate() {
  const periodSelect = document.getElementById('id_action_follow_up_period');
  const datepickerElement = $('#id_action_follow_up_date');
  
  // Start with today's date
  const startDate = new Date();
  let newFollowUpDate = new Date(startDate);
  
  const selectedPeriod = periodSelect.value;

  switch (selectedPeriod) {
    case '1 Week':
      newFollowUpDate.setDate(newFollowUpDate.getDate() + 7);
      break;
    case '2 Weeks':
      newFollowUpDate.setDate(newFollowUpDate.getDate() + 14);
      break;
    case '3 Weeks':
      newFollowUpDate.setDate(newFollowUpDate.getDate() + 21);
      break;
    case '1 Month':
      newFollowUpDate.setMonth(newFollowUpDate.getMonth() + 1);
      break;
    case '2 Months':
      newFollowUpDate.setMonth(newFollowUpDate.getMonth() + 2);
      break;
    case '3 Months':
      newFollowUpDate.setMonth(newFollowUpDate.getMonth() + 3);
      break;
    case '6 Months':
      newFollowUpDate.setMonth(newFollowUpDate.getMonth() + 6);
      break;
    default:
      // For "Other" or the empty value, use today's date
      newFollowUpDate = startDate;
      break;
  }
alert("New Follow Up Date: " + startDate.toLocaleDateString());
  // Set the datepicker with the corrected Date object
  datepickerElement.datepicker('setDate', newFollowUpDate);
  //datepickerElement.date(newFollowUpDate);
}

// Set the initial value on page load
window.onload = updateFollowUpDate;

 </script>

-->

{% endblock %}